<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
      body {font-family:'Helvetica Neue', Arial, sans-serif; color:#333; font-size:13px; line-height:17px;}
      body .name,body .note {white-space:pre-wrap;}
      body ul {list-style:disc; margin:0; padding:0;}
      body li {margin:4px 0 4px 20px; padding:0;}
      body>.name {font-size:16px; line-height:21px;}
      body>.note {font-size:13px; line-height:17px;}
      body>ul {margin-top:15px;}
      body .name.done {text-decoration:line-through; color:#999;}
      body .note {font-size:12px; color:#666;}
    </style>
  </head>
  <body>
    <span class="name">34-LinuxBash</span><ul><li><span class="name">grep</span><ul><li><span class="name">grep是Linux上的文本搜索工具. 可使用正则表达式.</span></li><li><span class="name">格式是: grep -参数 "待检索字符串" "待检索文件名或目录名"</span></li><li><span class="name">参数</span><ul><li><span class="name">-r: 递归检索所有子目录下的文件</span></li><li><span class="name">-c：只输出匹配行的计数。</span></li><li><span class="name">-I：不区分大 小写(只适用于单字符)。</span></li><li><span class="name">-h：查询多文件时不显示文件名。</span></li><li><span class="name">-l：查询多文件时只输出包含匹配字符的文件名。</span></li><li><span class="name">-n：显示匹配行及行号。</span></li><li><span class="name">-s：不显示不存在或无匹配文本的错误信息。</span></li><li><span class="name">-v：显示不包含匹配文本的所有行。</span></li></ul></li><li><span class="name">实例</span><ul><li><span class="name">grep ‘test’ d*      // 显示所有以d开头的文件中包含 test的行。</span></li><li><span class="name">grep ‘test’ aa bb cc    // 显示在aa，bb，cc文件中匹配test的行。</span></li><li><span class="name">grep ‘[a-z]\{5\}’ aa     // 显示所有包含每个字符串至少有5个连续小写字符的字符串的行。</span></li><li><span class="name">grep ‘w\(es\)t.*\1′ aa   // 如果west被匹配，则es就被存储到内存中，并标记为1，然后搜索任意个字符(.*)，这些字符后面紧跟着 另外一个es(\1)，找到就显示该行。如果用egrep或grep -E，就不用”\”号进行转义，直接写成 ’w(es)t.*\1′ 就可以了。</span></li><li><span class="name">grep magic /usr/src/Linux/Doc/*     // 在’/usr/src/Linux/Doc’目录下搜索带字符 串’magic’的文件</span></li><li><span class="name">grep "sort" *.doc       // 显示包含sort 且扩展名是doc文件.</span></li><li><span class="name">grep -vn "48" data.doc   // 显示所有不包含48的行</span></li><li><span class="name">grep '[239].' data.doc&nbsp; &nbsp;&nbsp; // 输出所有含有以2,3或9开头的，并且是两个数字的行</span></li></ul></li></ul></li><li><span class="name">文件和目录</span><ul><li><span class="name">绝对路径由 / 开始，如/usr/test/</span></li><li><span class="name">相对路径有如下几种:</span><ul><li><span class="name">. 表示当前目录,  .. 表示上级目录</span></li><li><span class="name">- ：表示上一次用的工作目录</span></li><li><span class="name">~ ：表示当前用户的 home 目录</span></li><li><span class="name">~user： 表示user用户的 home 目录</span></li></ul></li><li><span class="name">列出当前目录的文件:  ls。 -a：全部文件;&nbsp; -l：显示详细信息</span></li><li><span class="name">切换目录: cd</span></li><li><span class="name">显示当前目录: pwd</span></li><li><span class="name">建立新目录: mkdir -p：目录递归建立</span></li><li><span class="name">删除空目录: rmdir&nbsp;&nbsp;</span></li><li><span class="name">删除文件和目录: rm。 -f：强制删除； -r：删除目录</span></li><li><span class="name">复制文件: cp</span></li><li><span class="name">重命名目录和文件:  mv。&nbsp; -f：强制；-i：如果目标文件已经存在，则询问是否覆盖.</span></li><li><span class="name">建立空文件: touch+文件名</span></li><li><span class="name">测试文件（文件夹）相关属性: test.&nbsp; </span><ul><li><span class="name">-e：测试文件是否存在;&nbsp; </span></li><li><span class="name">-f：测试指定名称是否为文件;&nbsp; </span></li><li><span class="name">-d：测试指定名称是否为文件夹;&nbsp; </span></li><li><span class="name">-n：判断字符串是否非空，非空返回ture&nbsp;&nbsp;</span></li></ul></li><li><span class="name">修改文件或文件夹的权限: chmod。 </span><ul><li><span class="name">-r：支持子目录&nbsp;&nbsp; </span></li><li><span class="name">rg：chmod 777 /dev/pcui；其中：</span></li><li><span class="name">数字7表示权限，r=4,w=2,x=1, 7表示r+w+x, 即权限全开。</span></li><li><span class="name">三个值分别对应：owner、owner主、other组三类用户。</span></li></ul></li><li><span class="name">解压缩: </span><ul><li><span class="name">bzip2 格式的(.bz2), 使用: tar xvjf 文件</span></li><li><span class="name">zip格式(.gz), 使用: tar xvzf 文件名</span></li></ul></li><li><span class="name">建立软链接（符号链接）&nbsp;: ln -s /usr/local/bin/ctags /usr/bin/ctags</span></li><li><span class="name">寻找并批量删除文件: find ./ -name .git | xargs rm -rvf</span></li><li><span class="name">寻找并改变文件编码: </span><ul><li><span class="name">find -type f -exec sh -c 'iconv -f utf8 -t GBK -c $1&gt;$1.tmp; mv $1.temp ../gbk_txt/$1' -{} /,</span></li></ul></li><li><span class="name">将utf8编码转化为gbk编码:</span><ul><li><span class="name">find -type f -exec sh -c 'iconv -f utf-8 -t GBK -c $1 &gt; $1.tmp ; mv $1.tmp ../gbk-txt/$1' _ {} \;</span></li></ul></li><li><span class="name">打印目录及子目录中的所有有后缀的文件名:</span><ul><li><span class="name">find ./ -type f |egrep&nbsp; "*.[a-z]*" &gt; readme.txt&nbsp;</span></li></ul></li></ul></li><li><span class="name">时间日期</span><ul><li><span class="name">时间戳 to 时间</span><ul><li><span class="name">date -d @***(去掉后3位)</span></li></ul></li></ul></li><li><span class="name">分区管理</span><ul><li><span class="name">挂载emmc分区（要root权限）</span><ul><li><span class="name">mount -t vfat /dev/block/mmcblk0p3 /sdcard/fat</span></li><li><span class="name">linux的 mountpoint 真的是任意一个目录就可以!</span></li></ul></li><li><span class="name">显示硬盘使用情况: df&nbsp;</span><ul><li><span class="name">-a：显示特殊分区</span></li><li><span class="name">-h：以GB、MB、KB来显示size</span></li><li><span class="name">-T：显示分区的文件系统类型</span></li><li><span class="name">-i：显示inode数量</span></li></ul></li><li><span class="name">打印硬盘分区结构（如主引导区、分区表等）: dumpe2fs</span></li><li><span class="name">查看分区信息: mount</span></li><li><span class="name">按fat32 mount: mount -t vfat /dev/block/mmcblk0p1 /sdcard</span></li><li><span class="name">按ext3 mount, 且加rw权限: mount -t ext3 -o rw,remount /dev/block/mmcblk0p12 /system</span></li><li><span class="name">卸载分区: umount /sdcard</span></li><li><span class="name">fat分区扫描1: /system/bin/fsck_msdos -p -f /mnt/sdcard</span></li><li><span class="name">fat分区扫描2: fsck -t msdos -a /dev/block/mmcblk0p14</span></li><li><span class="name">扫描ext3 文件系统: /system/bin/e2fsck -p /dev/block/mmcblk0p6</span></li><li><span class="name">格式化为fat32: /system/bin/newfs_msdos -F 32 -O android -c 8 -s 1024 /dev/block/mmcblk0p14</span></li><li><span class="name">格式化为 ext3: mke2fs -j -L "logical" /dev/block/mmcblk0p6</span></li><li><span class="name">格式化u盘: mkfs.vfat -I /dev/sde（先用mount查看u盘挂在那个点上）</span></li></ul></li><li><span class="name">Shell 脚本</span><ul><li><span class="name">打印字符串: echo.   打印变量：echo $PATH</span></li><li><span class="name">变量及其赋值:</span><ul><li><span class="name">字符串表示一个变量，赋值用=；</span></li><li><span class="name">使用变量时用前缀$+变量名。如：Path=$PATH:\home\dmtsail\bin</span></li></ul></li><li><span class="name">用变量保存命令的输出: 使用``（非引号）&nbsp; eg：echo `date`</span></li><li><span class="name">shell脚本之使用变量</span><ul><li><span class="name">定义变量:  export my_VERSION=7x30_B001</span></li><li><span class="name">使用变量:  ${my_VERSION}</span></li></ul></li><li><span class="name">Linux 脚本无法运行的可能原因</span><ul><li><span class="name">脚本文件如果是在 windows侧编辑的，那么就需要看一下换行符是否为0d0a，如果是，要改成linux的0a格式。&nbsp;&nbsp;</span></li><li><span class="name">检查一下命令的拼写和大小写；</span></li><li><span class="name">是否目录错误, 使用ls 查看当前目录；</span></li><li><span class="name">是否没有运行权限, 使用 chmod 777 修改；</span></li></ul></li><li><span class="name">清屏: clear</span></li><li><span class="name">暂停等待按键:  read -n1 -p "Press and key to continue ..."</span></li></ul></li><li><span class="name">用户管理</span><ul><li><span class="name">切换为超级用户: su</span></li><li><span class="name">切换为指定用户: su 用户名</span></li><li><span class="name">使用超级用户权限运行当前命令: sudo + 命令, 其效力只限于当前命令。</span></li><li><span class="name">建立用户: useradd + 用户名</span></li><li><span class="name">删除用户: userdel + 用户名</span></li><li><span class="name">设置用户口令: passwd + 用户名</span></li><li><span class="name">ubuntu的root用户密码是什么？</span><ul><li><span class="name">ubuntu默认安装情况下root密码不确定，以防止用户用root权限破坏系统。安装过程中新建的账号是system权限的，可拥有sudo。但是有时候还是需要用root，此时可以用如下命令：sudo passwd root。</span></li><li><span class="name">先输入用户密码，再输入（两次）新的root密码，然后就可以使用root了！</span></li></ul></li></ul></li><li><span class="name">进程和内存管理</span><ul><li><span class="name">Linux进程的堆栈</span><ul><li><span class="name">Linux每个用户进程都有自己的堆栈，而且有两个，一个为系统堆栈，除1K的进程控制块外，还有7K的空间供内核进程调度时用于保存进程上下文。</span></li></ul></li><li><span class="name">列出进程: top, 其输出如下:</span><ul><li><span class="name">前五行是系统整体的统计信息。第一行是任务队列信息，同 uptime 命令的执行结果。其内容如下：</span></li><li><span class="name">01:06:48 当前时间</span></li><li><span class="name">up 1:22 系统运行时间，格式为时:分</span></li><li><span class="name">1 user 当前登录用户数</span></li><li><span class="name">load average: 0.06, 0.60, 0.48 系统负载，即任务队列的平均长度。</span></li><li><span class="name">三个数值分别为 1分钟、5分钟、15分钟前到现在的平均值。</span></li><li><span class="name">第二、三行为进程和CPU的信息。当有多个CPU时，这些内容可能会超过两行。内容如下：</span></li><li><span class="name">Tasks: 29 total 进程总数</span></li><li><span class="name">1 running 正在运行的进程数</span></li><li><span class="name">28 sleeping 睡眠的进程数</span></li><li><span class="name">0 stopped 停止的进程数</span></li><li><span class="name">0 zombie 僵尸进程数</span></li><li><span class="name">Cpu(s): 0.3% us 用户空间占用CPU百分比</span></li><li><span class="name">1.0% sy 内核空间占用CPU百分比</span></li><li><span class="name">0.0% ni 用户进程空间内改变过优先级的进程占用CPU百分比</span></li><li><span class="name">98.7% id 空闲CPU百分比</span></li><li><span class="name">0.0% wa 等待输入输出的CPU时间百分比</span></li><li><span class="name">0.0% hi</span></li><li><span class="name">0.0% si</span></li><li><span class="name">最后两行为内存信息。内容如下：</span></li><li><span class="name">Mem: 191272k total 物理内存总量</span></li><li><span class="name">173656k used 使用的物理内存总量</span></li><li><span class="name">17616k free 空闲内存总量</span></li><li><span class="name">22052k buffers 用作内核缓存的内存量</span></li><li><span class="name">Swap: 192772k total 交换区总量</span></li><li><span class="name">0k used 使用的交换区总量</span></li><li><span class="name">192772k free 空闲交换区总量</span></li><li><span class="name">123988k cached 缓冲的交换区总量。</span></li><li><span class="name">内存中的内容被换出到交换区，而后又被换入到内存，但使用过的交换区尚未被覆盖，</span></li><li><span class="name">该数值即为这些内容已存在于内存中的交换区的大小。</span></li><li><span class="name">相应的内存再次被换出时可不必再对交换区写入。</span></li><li><span class="name">进程信息区</span></li><li><span class="name">统计信息区域的下方显示了各个进程的详细信息。首先来认识一下各列的含义。</span></li><li><span class="name">序号 列名 含义</span></li><li><span class="name">a PID 进程id</span></li><li><span class="name">b PPID 父进程id</span></li><li><span class="name">c RUSER Real user name</span></li><li><span class="name">d UID 进程所有者的用户id</span></li><li><span class="name">e USER 进程所有者的用户名</span></li><li><span class="name">f GROUP 进程所有者的组名</span></li><li><span class="name">g TTY 启动进程的终端名。不是从终端启动的进程则显示为 ?</span></li><li><span class="name">h PR 优先级</span></li><li><span class="name">i NI nice值。负值表示高优先级，正值表示低优先级</span></li><li><span class="name">j P 最后使用的CPU，仅在多CPU环境下有意义</span></li><li><span class="name">k %CPU 上次更新到现在的CPU时间占用百分比</span></li><li><span class="name">l TIME 进程使用的CPU时间总计，单位秒</span></li><li><span class="name">m TIME+ 进程使用的CPU时间总计，单位1/100秒</span></li><li><span class="name">n %MEM 进程使用的物理内存百分比</span></li><li><span class="name">o VIRT 进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES</span></li><li><span class="name">p SWAP 进程使用的虚拟内存中，被换出的大小，单位kb。</span></li><li><span class="name">q RES 进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA</span></li><li><span class="name">r CODE 可执行代码占用的物理内存大小，单位kb</span></li><li><span class="name">s DATA 可执行代码以外的部分(数据段+栈)占用的物理内存大小，单位kb</span></li><li><span class="name">t SHR 共享内存大小，单位kb</span></li><li><span class="name">u nFLT 页面错误次数</span></li><li><span class="name">v nDRT 最后一次写入到现在，被修改过的页面数。</span></li><li><span class="name">w S 进程状态。</span></li><li><span class="name">D=不可中断的睡眠状态</span></li><li><span class="name">R=运行</span></li><li><span class="name">S=睡眠</span></li><li><span class="name">T=跟踪/停止</span></li><li><span class="name">Z=僵尸进程</span></li><li><span class="name">x COMMAND 命令名/命令行</span></li><li><span class="name">y WCHAN 若该进程在睡眠，则显示睡眠中的系统函数名</span></li><li><span class="name">z Flags 任务标志，参考 sched.h。</span></li><li><span class="name">默认情况下仅显示比较重要的 PID、USER、PR、NI、VIRT、RES、SHR、S、%CPU、%MEM、TIME+、COMMAND 列。可以通过下面的快捷键来更改显示内容。</span></li></ul></li><li><span class="name">查看后台执行的程序: ps -aux</span></li><li><span class="name">输出当前运行进程。可以获取进程号: ps：ps -x: 显示进程的运行时间</span></li><li><span class="name">杀掉进程: kill+进程号。注意，系统进程杀掉后会马上重启。</span></li><li><span class="name">查每个进程的内存使用: </span><ul><li><span class="name">dumpsys meminfo + 进程名。对单个进程的内存有很细节的说明，包括object和sql。</span></li></ul></li><li><span class="name">同时看所有进程的内存使用: procrank</span></li><li><span class="name">给出系统内存的大致使用情况: cat /proc/meminfo，注意数据的含义要辨别.</span></li><li><span class="name">给出各进程的vsize和rss: ps-x</span></li></ul></li><li><span class="name">网络管理</span><ul><li><span class="name">显示谁在线: who</span></li><li><span class="name">查看当前网络联机状态: netstat -a</span></li><li><span class="name">获取本机ip: ifconfig</span></li><li><span class="name">跟踪网络路由: traceroute + ping</span></li><li><span class="name">访问windows共享: 打开主文件夹，按Ctrl+L,输入 <a class="contentLink" target="_blank" rel="noreferrer" href="smb://ip">smb://ip</a>，输入用户名、密码</span></li></ul></li><li><span class="name">awk</span><ul><li><span class="name">Awk（Aho、Weinberger 和 Kernighan） — 一种编程语言，因其模式匹配语法而特别有用，通常用于数据检索和数据转换。</span></li><li><span class="name">它从（文件、程序输出或命令行输入）读取数据作为输入，根据一组预定义条件处理输入（如按字母顺序排序），然后输出处理过的数据。</span></li></ul></li></ul>
  </body>
</html>