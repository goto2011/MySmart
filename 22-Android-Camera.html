<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
      body {font-family:'Helvetica Neue', Arial, sans-serif; color:#333; font-size:13px; line-height:17px;}
      body .name,body .note {white-space:pre-wrap;}
      body ul {list-style:disc; margin:0; padding:0;}
      body li {margin:4px 0 4px 20px; padding:0;}
      body>.name {font-size:16px; line-height:21px;}
      body>.note {font-size:13px; line-height:17px;}
      body>ul {margin-top:15px;}
      body .name.done {text-decoration:line-through; color:#999;}
      body .note {font-size:12px; color:#666;}
    </style>
  </head>
  <body>
    <span class="name">22-Android-Camera</span><ul><li><span class="name">Camera API 2 提供灵活性, 可提供rawdata, yuv, jpeg 等格式的数据流到应用层.</span></li><li><span class="name">ZSL: Zero Shutter Lag, 零延迟快门</span></li><li><span class="name">启动Camera的两种方式</span><ul><li><span class="name">直接在intent中指定应用程序的包名（前提是知道完整的包名）</span></li><li><span class="name">使用隐式intent的方式来启动包名</span><ul><li><span class="name">Intent camera = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);</span></li><li><span class="name">startActivity(camera);</span></li></ul></li></ul></li><li><span class="name">拍照完成之后获取图片</span><ul><li><span class="name">第一种方式, 直接通过data中获取，但得到的照片是缩略图</span><ul><li><span class="name"><span class="contentTag" title="Filter @Override">@<span class="contentTagText">Override</span><span class="contentTagNub"></span></span> </span></li><li><span class="name">protected void onActivityResult(int requestCode, int resultCode, Intent data) { </span><ul><li><span class="name">super.onActivityResult(requestCode, resultCode, data); </span></li></ul></li><li><span class="name">}</span></li></ul></li><li><span class="name">第二种方式</span><ul><li><span class="name">step1: 获取文件保存路径</span></li><li><span class="name">private String mFilePath; // 定义sd卡路径</span></li><li><span class="name"><span class="contentTag" title="Filter @Override">@<span class="contentTagText">Override</span><span class="contentTagNub"></span></span></span></li><li><span class="name">protected void onCreate(Bundle savedInstanceState) {</span><ul><li><span class="name">super.onCreate(savedInstanceState);</span></li><li><span class="name">setContentView(R.layout.activity_main);</span></li><li><span class="name">mFilePath = Environment.getExternalStorageDirectory().getPath();  // 获得sd卡路径</span></li><li><span class="name">mFilePath = mFilePath + "/" + "temp.png";</span></li><li><span class="name">init();</span></li></ul></li><li><span class="name">}</span></li><li><span class="name">step2: 启动相机</span></li><li><span class="name">Intent camera2 = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);</span></li><li><span class="name">Uri photoUri = Uri.fromFile(new File(mFilePath));</span></li><li><span class="name">camera2.putExtra(MediaStore.EXTRA_OUTPUT, photoUri);</span></li><li><span class="name">startActivityForResult(camera2, REQ_2);  // 通过返回requestCode来读取相机照片</span></li><li><span class="name">step3: 获取文件流，并转换为bitmap显示出来</span></li><li><span class="name">FileInputStream fis = null;</span></li><li><span class="name">try {</span><ul><li><span class="name">// 将文件转换成Bitmap </span></li><li><span class="name">fis = new FileInputStream(mFilePath); </span></li><li><span class="name">Bitmap bitmap = BitmapFactory.decodeStream(fis); </span></li><li><span class="name">iv_photo.setImageBitmap(bitmap); </span></li></ul></li><li><span class="name">} catch (FileNotFoundException e) {</span><ul><li><span class="name"> e.printStackTrace(); </span></li></ul></li><li><span class="name">} finally {</span><ul><li><span class="name">try { </span><ul><li><span class="name">fis.close();</span></li></ul></li><li><span class="name">} catch (IOException e) {</span><ul><li><span class="name">e.printStackTrace(); </span></li></ul></li><li><span class="name">}</span></li></ul></li><li><span class="name">}</span></li></ul></li><li><span class="name"></span></li></ul></li><li><span class="name">自定义相机</span><ul><li><span class="name">Step1: 创建相机</span><ul><li><span class="name">private Camera getCamera() {</span><ul><li><span class="name">//获取Camera 注意导包正确 </span></li><li><span class="name">Camera camera = null; </span></li><li><span class="name">try {</span><ul><li><span class="name">camera = Camera.open();</span></li></ul></li><li><span class="name">} catch (Exception e) {</span><ul><li><span class="name">e.printStackTrace(); </span></li></ul></li><li><span class="name">} </span></li><li><span class="name">return camera;</span></li></ul></li><li><span class="name">} </span></li><li><span class="name">private Camera mCamera;</span></li></ul></li><li><span class="name">Step2: 创建SurfaceView</span><ul><li><span class="name">mSurface = (SurfaceView) findViewById(R.id.preview);</span></li><li><span class="name">mHolder.addCallback(this);</span></li></ul></li><li><span class="name">Step3: 关联相机和SurfaceView</span><ul><li><span class="name">mHolder = mSurface.getHolder();</span></li></ul></li><li><span class="name">Step4: 调整相机的显示效果</span><ul><li><span class="name">public void capture(View v) {</span><ul><li><span class="name">// 获取当前照相机参数</span></li><li><span class="name">Camera.Parameters parameters = mCamera.getParameters();</span></li><li><span class="name">// 设置参数</span></li><li><span class="name">parameters.setPictureFormat(ImageFormat.JPEG);</span></li><li><span class="name">//设置照片格式</span></li><li><span class="name">parameters.setPictureSize(800, 400);</span></li><li><span class="name">//设置大小</span></li><li><span class="name">parameters.setFocusMode(Camera.Parameters.FLASH_MODE_AUTO);</span></li><li><span class="name">//设置对焦回调函数, 设置对焦模式</span></li><li><span class="name">mCamera.autoFocus(new Camera.AutoFocusCallback() {</span><ul><li><span class="name"><span class="contentTag" title="Filter @Override">@<span class="contentTagText">Override</span><span class="contentTagNub"></span></span> public void onAutoFocus(boolean success, Camera camera) {</span><ul><li><span class="name">if (success) {</span><ul><li><span class="name">//当对焦成功时获取图片</span></li><li><span class="name">mCamera.takePicture(null, null, mPictureCallback);</span></li></ul></li><li><span class="name">}</span></li></ul></li><li><span class="name">}</span></li></ul></li><li><span class="name">});</span></li></ul></li><li><span class="name">}</span></li></ul></li></ul></li></ul>
  </body>
</html>