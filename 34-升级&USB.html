<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
      body {font-family:'Helvetica Neue', Arial, sans-serif; color:#333; font-size:13px; line-height:17px;}
      body .name,body .note {white-space:pre-wrap;}
      body ul {list-style:disc; margin:0; padding:0;}
      body li {margin:4px 0 4px 20px; padding:0;}
      body>.name {font-size:16px; line-height:21px;}
      body>.note {font-size:13px; line-height:17px;}
      body>ul {margin-top:15px;}
      body .name.done {text-decoration:line-through; color:#999;}
      body .note {font-size:12px; color:#666;}
    </style>
  </head>
  <body>
    <span class="name"><span class="innerContentContainer">34-升级&amp;USB</span></span><ul><li><span class="name"><span class="innerContentContainer">FTM模式</span></span><ul><li><span class="name"><span class="innerContentContainer">开机进入recovery机器人界面，且屏幕中间显示“factory”。</span></span></li><li><span class="name"><span class="innerContentContainer">是否进FTM在misc分区中设置。</span></span></li><li><span class="name"><span class="innerContentContainer">FTM子模式有哪几种？</span></span><ul><li><span class="name"><span class="innerContentContainer">NV 453=1，进纯FTM模式；</span></span></li><li><span class="name"><span class="innerContentContainer">如果再加上NV 60003的值，进 FTM各子模式。</span></span><ul><li><span class="name"><span class="innerContentContainer">=1，wifi 校准；</span></span></li><li><span class="name"><span class="innerContentContainer">=2，wifi 环回测试；</span></span></li><li><span class="name"><span class="innerContentContainer">=3，BT 校准。</span></span></li></ul></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">recovery</span></span><ul><li><span class="name"><span class="innerContentContainer">recovery是一种启动模式、一个分区、一个独立的运行单元，也是一个有main()入口的linux程序。</span></span></li><li><span class="name"><span class="innerContentContainer">recovery有自己的kernel，以及运行其上的完成recovery各子功能的linux应用。</span></span></li><li><span class="name"><span class="innerContentContainer">如何进入recovery？</span></span><ul><li><span class="name"><span class="innerContentContainer">按音量上键开机, 进recovery菜单；</span></span></li><li><span class="name"><span class="innerContentContainer">NV 453=1，进FTM模式；</span></span></li><li><span class="name"><span class="innerContentContainer">NV 60002=1（UMTS），或NV 60009=1（CDMA），进快速注册模式；</span></span></li><li><span class="name"><span class="innerContentContainer">NV 60004=1，settings菜单恢复出厂设置即是设置这个值后重启。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">recovery的主要功能</span></span><ul><li><span class="name"><span class="innerContentContainer">格式化data分区</span></span><ul><li><span class="name"><span class="innerContentContainer">格式化前将 /data/dataapp 中的文件备份到cache分区，格式化后再恢复回来。</span></span></li><li><span class="name"><span class="innerContentContainer">这个目录是放运营商定制apk, 不能删除了.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">格式化内置SD卡</span></span></li><li><span class="name"><span class="innerContentContainer">格式化cache分区</span></span></li><li><span class="name"><span class="innerContentContainer">格式化cache分区</span></span></li><li><span class="name"><span class="innerContentContainer">备份数据恢复</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">misc分区作为模块间传递命令的载体</span></span><ul><li><span class="name"><span class="innerContentContainer">好处是重启前后都在。大小一般为2M。</span></span></li><li><span class="name"><span class="innerContentContainer">misc分区可以升级, 升级大包中有，以便初始化该分区。</span></span></li><li><span class="name"><span class="innerContentContainer">misc分区中的数据</span></span><ul><li><span class="name"><span class="innerContentContainer">第1个字段, 关机充电</span></span></li><li><span class="name"><span class="innerContentContainer">第2个字段, recovery信息</span></span></li><li><span class="name"><span class="innerContentContainer">第3个字段, recovery掉电保护</span></span></li><li><span class="name"><span class="innerContentContainer">第4个字段, ota升级标志</span></span></li><li><span class="name"><span class="innerContentContainer">第5个字段, kernel panic信息</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">cust升级</span></span><ul><li><span class="name"><span class="innerContentContainer">cust 升级即定制升级. 定制需求一般来自运营商.</span></span></li><li><span class="name"><span class="innerContentContainer">方案设计原则</span></span><ul><li><span class="name"><span class="innerContentContainer">cust分区是个全集, 包括全球所有定制的配置文件.</span></span></li><li><span class="name"><span class="innerContentContainer">系统运行时, 通过软链接方式将自己需要的子集载入系统, 并mount 到 /data/cust. </span></span></li><li><span class="name"><span class="innerContentContainer">应用访问 /data/cust 来读取自己的配置信息, 完全透明访问. </span></span></li><li><span class="name"><span class="innerContentContainer">从 /data/custom.bin 可读取当前使用的是哪个运营商.</span></span></li><li><span class="name"><span class="innerContentContainer">由此可做到代码和定制归一化。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">cust包的内容</span></span><ul><li><span class="name"><span class="innerContentContainer">cust分区</span></span><ul><li><span class="name"><span class="innerContentContainer">所有定制信息，以“运营商信息/国家“为路径组织起来。</span></span></li><li><span class="name"><span class="innerContentContainer">包括ap侧到的定制配置文件（主要是xml文件）、modem侧的logo和定制nv。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">vendor_id包</span></span><ul><li><span class="name"><span class="innerContentContainer">很小, 一般十几个字节.</span></span></li><li><span class="name"><span class="innerContentContainer">就是文本文件. 内容是 运营商信息 + 国家信息，比如vodafone/German。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">cust包升级方式</span></span><ul><li><span class="name"><span class="innerContentContainer">大包升级的最后一步, 自动升级cust包;</span></span></li><li><span class="name"><span class="innerContentContainer">生产工位打背贴时，通过后台写入vendor_id. 会激活cust升级.</span></span></li><li><span class="name"><span class="innerContentContainer">在研发环境下, 通过diag命令, 切换运营商, 也会触发cust升级.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">升级流程</span></span><ul><li><span class="name"><span class="innerContentContainer">aboot 从oeminfo中读vendor id, 写到 cmdline中。</span></span><ul><li><span class="name"><span class="innerContentContainer">以通过如下命令查看： cat /proc/cmdline</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">init进程会对比 /proc/cmdline（A） 和 /data/custom.bin（B） 的值。会有几种场景:</span></span><ul><li><span class="name"><span class="innerContentContainer">第一次开机，A与B都是空的。</span></span><ul><li><span class="name"><span class="innerContentContainer">init 的做法是：写 hw/default 到B，然后激活 init.rc中的on cust，按默认值激活cust升级, 完成后然后重启。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">第二次开机，A空B不空，则正常启动。</span></span></li><li><span class="name"><span class="innerContentContainer">如果A&lt;&gt;B(原因是升级vendor信息后开机). 则:</span></span><ul><li><span class="name"><span class="innerContentContainer">重启，先进行恢复出厂设置.</span></span><ul><li><span class="name"><span class="innerContentContainer">cust升级前为什么要recovery?</span></span></li><li><span class="name"><span class="innerContentContainer">因为要把data分区中的软链接都删除，如果删除失败则cust升级会失败。</span></span></li><li><span class="name"><span class="innerContentContainer">以防万一，就把data分区格式化一遍。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">然后做on cust操作</span></span><ul><li><span class="name"><span class="innerContentContainer">on cust升级之init.rc中定义，完成三种功能：</span></span></li><li><span class="name"><span class="innerContentContainer">custcopy：copy一个文件；</span></span></li><li><span class="name"><span class="innerContentContainer">custsymlink：copy一个目录；</span></span></li><li><span class="name"><span class="innerContentContainer">load_oemlogo：copy logo。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">最后停在recovery界面下。</span></span></li><li><span class="name"><span class="innerContentContainer">以上就是所谓的cust升级流程.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">如果A=B（非首次开机），不做任何事。</span></span></li><li><span class="name"><span class="innerContentContainer">如果是B不存在，说明刚升过级，且没有走cust升级流程, 则把A写入B，然后进入cust升级流程。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">预置apk的安装位置</span></span><ul><li><span class="name"><span class="innerContentContainer">系统apk 放在 /system/app下，不可删除，恢复出厂设置不会删除。</span></span></li><li><span class="name"><span class="innerContentContainer">厂商预制apk 放在 /system/delapp，可删除，但是恢复出厂设置又会回来。</span></span></li><li><span class="name"><span class="innerContentContainer">用户安装apk 放在 /data/app下，可删除，恢复出厂设置会删除。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">hota升级</span></span><ul><li><span class="name"><span class="innerContentContainer">ota升级: fireware over the air，无线补丁升级。</span></span></li><li><span class="name"><span class="innerContentContainer">有三种方案：</span></span><ul><li><span class="name"><span class="innerContentContainer">redband的fota方案</span></span><ul><li><span class="name"><span class="innerContentContainer">该方案每台手机收费0.2美金。所以现在基本不用.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">google提供的ota方案</span></span><ul><li><span class="name"><span class="innerContentContainer">部分运营商明确要使用google方案.</span></span></li><li><span class="name"><span class="innerContentContainer">升级包需要放在google的服务器上。</span></span></li><li><span class="name"><span class="innerContentContainer">gota升级有如下规则：原始版本与目标版本的平台编译时间戳必须不同，如果相同则google服务器上无法检测到。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">华为实现的hota方案. 常用.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">hota包下载到手机的方式</span></span><ul><li><span class="name"><span class="innerContentContainer">通过settings下载hota升级包</span></span><ul><li><span class="name"><span class="innerContentContainer">根据手机当前版本号或IMEI号找下载包.</span></span></li><li><span class="name"><span class="innerContentContainer">菜单中只能搜索到一个差分包。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">自动下载</span></span><ul><li><span class="name"><span class="innerContentContainer">默认自动下载周期是10天，周期可通过cust定制。</span></span></li><li><span class="name"><span class="innerContentContainer">用户可在菜单中定制周期，也可以将自动检测关闭。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">下载方式</span></span><ul><li><span class="name"><span class="innerContentContainer">用android原生的DownloadProvider，支持断点续传。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">差分包的保存位置</span></span><ul><li><span class="name"><span class="innerContentContainer">升级包展开后，有sd卡的放在sd卡上，</span></span></li><li><span class="name"><span class="innerContentContainer">无sd卡的放在内置卡，</span></span></li><li><span class="name"><span class="innerContentContainer">内置卡空间不足，放在 /cache/fotapkg下。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">data分区的问题</span></span><ul><li><span class="name"><span class="innerContentContainer">hoto升级不会擦除/data分区，所以用户数据保留。</span></span></li><li><span class="name"><span class="innerContentContainer">但升级过程中可以往 data分区添加文件。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">升级过程</span></span><ul><li><span class="name"><span class="innerContentContainer">ap侧下载升级包</span></span></li><li><span class="name"><span class="innerContentContainer">调用hota_start_update()</span></span></li><li><span class="name"><span class="innerContentContainer">设置misc信息</span></span><ul><li><span class="name"><span class="innerContentContainer">写入misc的信息如下：update_package=SDCARD:文件名.zip </span></span></li><li><span class="name"><span class="innerContentContainer">或者 CACHE:文件名.zip</span></span></li><li><span class="name"><span class="innerContentContainer">取决于差分包的保存位置。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">系统重启进入recovery模式</span></span></li><li><span class="name"><span class="innerContentContainer">hota在recovery中完成</span></span><ul><li><span class="name"><span class="innerContentContainer">recovery中，get_args()函数从misc分区或command文件中获取升级包位置。</span></span></li><li><span class="name"><span class="innerContentContainer">调用ota_status_check()，读misc信息，确定是hota，还是fota。如果都不是，则清空misc和cache，然后重启。</span></span></li><li><span class="name"><span class="innerContentContainer">调用do_hota_update()，完成第一阶段升级，即差分升级。</span></span></li><li><span class="name"><span class="innerContentContainer">调用maybe_install_fireware_update()，将modem侧升级的update.app写入cache分区，设置misc信息为：hota_update_radio。</span></span></li><li><span class="name"><span class="innerContentContainer">手机再次重启，oemsbl_dload_check()中读取misc信息，然后调用dload_sd()完成对aboot、boot、recovery和modem侧诸模块升级。</span></span></li><li><span class="name"><span class="innerContentContainer">升级完成后，重启进入recovery，清除cache和misc对应字段，然后重启。</span></span></li><li><span class="name"><span class="innerContentContainer">升级log放在 data/last.log中，注意进入recovery会被覆盖。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">root过的手机不能进行hota升级。</span></span></li><li><span class="name"><span class="innerContentContainer">hota升级可删除文件</span></span><ul><li><span class="name"><span class="innerContentContainer">hota升级脚本为 /META-INF/com/google/android/updater-script, </span></span></li><li><span class="name"><span class="innerContentContainer">在其中的delete字段中加一行：delete("/data/misc/wifi/load/ar6000.ko");</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">差分算法</span></span><ul><li><span class="name"><span class="innerContentContainer">如果不一致, 拷贝a文件，生成备份文件，叫a.backup。</span></span></li><li><span class="name"><span class="innerContentContainer">差分升级只支持 system、cust等ext4分区。</span></span></li><li><span class="name"><span class="innerContentContainer">具体过程如下：</span></span></li><li><span class="name"><span class="innerContentContainer">先检查新旧文件是否一致，一致就跳过；</span></span></li><li><span class="name"><span class="innerContentContainer">如果system剩余空间小于a文件的1.5倍，则放到/cache分区，如果cache空间也不够，则报错。</span></span></li><li><span class="name"><span class="innerContentContainer">对a.backup进行差分，升级完成后命名为a，拷贝到原处。这样做的目的是掉电保护。</span></span></li><li><span class="name"><span class="innerContentContainer">其实是用google ota的算法。对ext4的文件系统来说，有专门的命令对比两个ext4文件系统的差异，因此极大的降低了方案的复杂程度。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">升级安全方案</span></span><ul><li><span class="name"><span class="innerContentContainer">升级包结构如下:</span></span></li><li><span class="name"><span class="innerContentContainer">MD5-RSA</span></span><ul><li><span class="name"><span class="innerContentContainer">存放: CRC模块经过MD5加密后，再经过私钥A加密后的数据，128B。</span></span></li><li><span class="name"><span class="innerContentContainer">它的检验方式: oeminfo分区有公钥A，将密文解密为MD5数据，然后将明文进行MD5加密，两个对比，如一致则ok。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">CRC</span></span><ul><li><span class="name"><span class="innerContentContainer">升级包以下各模块的CRC值表。</span></span></li><li><span class="name"><span class="innerContentContainer">按模块顺序，每32K数据算一个16位的CRC值，不足32K的也算一个CRC。</span></span></li><li><span class="name"><span class="innerContentContainer">最大长度为128KB，对应升级包为1GB大小。(现在肯定改了)</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">AMSS_ECC</span></span><ul><li><span class="name"><span class="innerContentContainer">目的是给amss加密。</span></span></li><li><span class="name"><span class="innerContentContainer">它分为密文和明文两部分，明文为amss模块的ecc列表，每512B字节算16位的ecc数据；</span></span></li><li><span class="name"><span class="innerContentContainer">密文为明文做md5，然后再rsa加密后的1024位数据。</span></span></li><li><span class="name"><span class="innerContentContainer">amss的ecc检验方案在智能机上没有使用。原因是没有必要去保护。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">USB autorun方案</span></span><ul><li><span class="name"><span class="innerContentContainer">方案的主要思想是自动安装驱动和后台软件.</span></span></li><li><span class="name"><span class="innerContentContainer">它要解决的核心问题是手机侧如何知道pc上是否安装了usb 驱动。</span></span></li><li><span class="name"><span class="innerContentContainer">有两种方案:</span></span><ul><li><span class="name"><span class="innerContentContainer">由手机来判断pc是否安装驱动.</span></span><ul><li><span class="name"><span class="innerContentContainer">优缺点: 便利. 但是受制于windows的实现.</span></span></li><li><span class="name"><span class="innerContentContainer">方案也有两种:</span></span><ul><li><span class="name"><span class="innerContentContainer">延迟判断法</span></span><ul><li><span class="name"><span class="innerContentContainer">usb驱动按照modem、diag口（串口）、光盘来设计，第一个口是modem。</span></span></li><li><span class="name"><span class="innerContentContainer">手机插入后，先报唯一一个光盘。</span></span></li><li><span class="name"><span class="innerContentContainer">然后，如果pc安装过驱动，则pc会认为第一个端口为modem，它不会发命令查看光盘的内容。</span></span></li><li><span class="name"><span class="innerContentContainer">如果没有安装驱动，pc会加载标准光盘启动，并查看光盘内容。</span></span></li><li><span class="name"><span class="innerContentContainer">经验表明，这个时间大约是3秒。3秒内，pc没查询光盘内容，则表明它安装过驱动，此时手机自动切换为三端口。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">set feature判断法</span></span><ul><li><span class="name"><span class="innerContentContainer">这个方案的本质和延迟判断法基本一样，根据pc在两种情况下的行为不同来判断。</span></span></li><li><span class="name"><span class="innerContentContainer">但是判断的是set feature命令。</span></span></li><li><span class="name"><span class="innerContentContainer">如果没有安装驱动，pc会加载光盘驱动，不会发set feature命令；</span></span></li><li><span class="name"><span class="innerContentContainer">如果相反，则会发。</span></span></li><li><span class="name"><span class="innerContentContainer">所以当收到set feature时，就切换三端口。</span></span></li></ul></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">由手机光盘中的exe程序自动启动后从windows系统中判断是否安装驱动。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">Android手机上, 没有使用 autorun方案, 仅保留光盘.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">U盘的serial number问题</span></span><ul><li><span class="name"><span class="innerContentContainer">windows对U盘的识别策略是：</span></span><ul><li><span class="name"><span class="innerContentContainer">如果串号为空，则只识别第一个U盘；</span></span></li><li><span class="name"><span class="innerContentContainer">如果不为空，但相同，则多个U盘插入，windows会重启；</span></span></li><li><span class="name"><span class="innerContentContainer">如果不为空，且不同，则可分别识别。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">对u盘sn号的处理</span></span><ul><li><span class="name"><span class="innerContentContainer">google模式下用蓝牙地址；</span></span></li><li><span class="name"><span class="innerContentContainer">CTS模式下用字符串“hw_smart_phone”的asc码（因为CTS需要在linux下测试，需要串号）。</span></span></li><li><span class="name"><span class="innerContentContainer">normal等其它模式都没有sn号。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">各种版本的默认USB模式</span></span><ul><li><span class="name"><span class="innerContentContainer">国内升级：normal；</span></span></li><li><span class="name"><span class="innerContentContainer">海外升级：google；</span></span></li><li><span class="name"><span class="innerContentContainer">烧片：生产模式。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">USB spec</span></span><ul><li><span class="name"><span class="innerContentContainer">device</span></span><ul><li><span class="name"><span class="innerContentContainer">对应物理设备本身。</span></span></li><li><span class="name"><span class="innerContentContainer">device descriptor包括：</span></span><ul><li><span class="name"><span class="innerContentContainer">USB版本号</span></span></li><li><span class="name"><span class="innerContentContainer">设备类型</span></span></li><li><span class="name"><span class="innerContentContainer">子类型</span></span></li><li><span class="name"><span class="innerContentContainer">协议类型（这三个字段在多设备中是空的）</span></span></li><li><span class="name"><span class="innerContentContainer">EP包大小</span></span></li><li><span class="name"><span class="innerContentContainer">vendor id及字符串</span></span></li><li><span class="name"><span class="innerContentContainer">产品id及字符串</span></span></li><li><span class="name"><span class="innerContentContainer">支持的配置数量</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">configuration</span></span><ul><li><span class="name"><span class="innerContentContainer">一个device至少有个一个配置，一般就一个。</span></span></li><li><span class="name"><span class="innerContentContainer">config des包括：</span></span><ul><li><span class="name"><span class="innerContentContainer">支持的interface数量</span></span></li><li><span class="name"><span class="innerContentContainer">是否直供电</span></span></li><li><span class="name"><span class="innerContentContainer">是否支持远程唤醒</span></span></li><li><span class="name"><span class="innerContentContainer">需要的最大总线电量</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">interface</span></span><ul><li><span class="name"><span class="innerContentContainer">一个配置至少一个接口；</span></span></li><li><span class="name"><span class="innerContentContainer">多用途设备会有多个接口；接口数量和端口数量一一对应。</span></span></li><li><span class="name"><span class="innerContentContainer">interface des中包括：</span></span><ul><li><span class="name"><span class="innerContentContainer">设备类型</span></span></li><li><span class="name"><span class="innerContentContainer">子类型</span></span></li><li><span class="name"><span class="innerContentContainer">协议类型</span></span></li><li><span class="name"><span class="innerContentContainer">支持的EP数量</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">EP</span></span><ul><li><span class="name"><span class="innerContentContainer">EP是位于usb设备或主机上的一个数据缓冲区。一个端口至少有一对端点。</span></span></li><li><span class="name"><span class="innerContentContainer">EP des包括：</span></span><ul><li><span class="name"><span class="innerContentContainer">EP地址</span></span><ul><li><span class="name"><span class="innerContentContainer">EP地址包括ID和方向。每个EP是编号和方向唯一确定的.</span></span></li><li><span class="name"><span class="innerContentContainer">EP地址的结构是：0-3为EP id，即最多有16对。</span></span></li><li><span class="name"><span class="innerContentContainer">方向</span></span><ul><li><span class="name"><span class="innerContentContainer">IN（device-&gt;host）</span></span></li><li><span class="name"><span class="innerContentContainer">OUT（hos-&gt;device）。</span></span></li><li><span class="name"><span class="innerContentContainer">第7位为方向：out=0，in=1.</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">传输类型</span></span><ul><li><span class="name"><span class="innerContentContainer">control: 用于控制，专指EP0</span></span><ul><li><span class="name"><span class="innerContentContainer">host发起的配置命令等，专用EP0通道。</span></span></li><li><span class="name"><span class="innerContentContainer">EP0为短向的，其它都是单向的。</span></span></li><li><span class="name"><span class="innerContentContainer">可分配10%带宽，如不用则分配给bulk传输。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">bulk: 块传输. 比如U盘.</span></span><ul><li><span class="name"><span class="innerContentContainer">支持大量数据，但无时间要求。</span></span></li><li><span class="name"><span class="innerContentContainer">块传输没有保留带宽，但可使用当前总线所有空闲带宽，最高可达90%。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">interrupt: 中断传输. 比如键盘鼠标.</span></span><ul><li><span class="name"><span class="innerContentContainer">响应时间受限的少量数据，如事件通知、键盘、鼠标设备等。</span></span></li><li><span class="name"><span class="innerContentContainer">中断传输在初始化时就会申请足够的带宽，如果当前系统满足不了，则初始化失败。</span></span></li><li><span class="name"><span class="innerContentContainer">申请的带宽会一直保留。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">同步传输: 比如USB语音.</span></span><ul><li><span class="name"><span class="innerContentContainer">响应时间受限的大量数据，如语音通话。同步传输可分配90%的带宽。</span></span></li></ul></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">EP 0为控制通道，不需要EP des。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">windows系统usb识别的特殊问题</span></span><ul><li><span class="name"><span class="innerContentContainer">windows用vid、pid、interface id来区分一个usb设备</span></span><ul><li><span class="name"><span class="innerContentContainer">如果3者都一样，则被认为是同一个设备。</span></span></li><li><span class="name"><span class="innerContentContainer">windows会保存EP number到注册表中, 而不从驱动配置文件中获取.</span></span></li><li><span class="name"><span class="innerContentContainer">如果某个设备修改了EP，则需要更新这三个中的至少一个，否则会通讯失败。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">windows识别设多端口备的另一个要求</span></span><ul><li><span class="name"><span class="innerContentContainer">该设备各端口的interface id必须是从0开始，连续排列的。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">如何区分usb host还是usb充电器？</span></span><ul><li><span class="name"><span class="innerContentContainer">当前高通方案是，有usb插入，先识别为usb，然后在usb中断中识别是不是充电器。</span></span></li><li><span class="name"><span class="innerContentContainer">方法是给D+、D-上电，usb host会给D+、D-加下拉电阻，外部上电，内部状态不变。</span></span></li><li><span class="name"><span class="innerContentContainer">而充电器是D+、D-短接的，外部上电，内部就上拉。如此就识别到了。</span></span></li><li><span class="name"><span class="innerContentContainer">非官方充电器，如果没做短接，有两个选择，1是分别上拉看情况；2是就认为是usb，反正后续usb协商无响应，对系统没影响。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">传输的发起者</span></span><ul><li><span class="name"><span class="innerContentContainer">除了中断传输，允许device发起外，其中传输都是host发起。</span></span></li><li><span class="name"><span class="innerContentContainer">正是这个原因，所以网卡、modem等都需要interrupt EP，因为它们需要device发起的传输。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">传输的物理单位</span></span><ul><li><span class="name"><span class="innerContentContainer">帧，时间概念。</span></span></li><li><span class="name"><span class="innerContentContainer">1毫秒为1帧，usb传输按帧来组织传输。</span></span></li><li><span class="name"><span class="innerContentContainer">对usb2.0，大约是12K大小。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">传输的逻辑单位</span></span><ul><li><span class="name"><span class="innerContentContainer">传输。一次请求的发起和结束。</span></span></li><li><span class="name"><span class="innerContentContainer">事务。一个传输包括一个或多个事务。</span></span><ul><li><span class="name"><span class="innerContentContainer">事务由3段组成：标记、数据和握手。</span></span></li><li><span class="name"><span class="innerContentContainer">每段由1-2个包组成，分别叫标记包、数据包和握手包。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">包</span></span><ul><li><span class="name"><span class="innerContentContainer">只有数据包中有数据，最长不超过64B。</span></span></li><li><span class="name"><span class="innerContentContainer">包由PID、帧编号、地址、CRC和数据组成。</span></span></li><li><span class="name"><span class="innerContentContainer">特色包包括帧同步包，包含SOF记号标示帧起始；</span></span></li><li><span class="name"><span class="innerContentContainer">还有低速向导包。</span></span></li><li><span class="name"><span class="innerContentContainer">不同传输模式下，包结构不同。</span></span></li><li><span class="name"><span class="innerContentContainer">块传输的包大小</span></span><ul><li><span class="name"><span class="innerContentContainer">1.1协议是 64B;</span></span></li><li><span class="name"><span class="innerContentContainer">2.0协议是 512B。</span></span></li></ul></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">著名的零包问题</span></span><ul><li><span class="name"><span class="innerContentContainer">usb协议中规定，小于size的包表示transfer结束.</span></span></li><li><span class="name"><span class="innerContentContainer">所以如果数据大小正好整除，那么就需要传输一个零包。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">USB远程唤醒</span></span><ul><li><span class="name"><span class="innerContentContainer">suspend的目的是为了节能。</span></span></li><li><span class="name"><span class="innerContentContainer">当device处在挂起状态时，它从总线上吸取的电流在500uA到2.5mA之间。</span></span></li><li><span class="name"><span class="innerContentContainer">当host检测总线没有活动一段时间后（大约3-5秒），就会把总线置为低电模式，并不再发帧开始包。</span></span></li><li><span class="name"><span class="innerContentContainer">当device 3ms没有收到帧开始包后，就应该进入挂起状态，10ms后必须进入此状态。</span></span></li><li><span class="name"><span class="innerContentContainer">此外，host端在必要的情况下，可随时通过set_prot_feather请求来挂起device。</span></span></li><li><span class="name"><span class="innerContentContainer">设备处在挂起状态时，两种情况可以使它resume:</span></span><ul><li><span class="name"><span class="innerContentContainer">一是总线上的任何活动都导致resume；</span></span></li><li><span class="name"><span class="innerContentContainer">二是如果device有远程唤醒机制，那么device可在任何情况下请求恢复。</span></span></li></ul></li><li><span class="name"></span></li></ul></li><li><span class="name"><span class="innerContentContainer">双U盘方案</span></span><ul><li><span class="name"><span class="innerContentContainer">驱动: androdi_usb_pdata{} 之 nluns = 2，即可。</span></span></li><li><span class="name"><span class="innerContentContainer">挂载点: system/etc/vold.conf，volume_usb2 之 media_path = /devices/platform/msm_hsusb_host/usb2。</span></span></li><li><span class="name"><span class="innerContentContainer">FWK: vold模块的修改较多.</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">USB线的物理结构</span></span><ul><li><span class="name"><span class="innerContentContainer">一条usb线分别有地线、电源线、D+、D- 4条线构成。</span></span></li><li><span class="name"><span class="innerContentContainer">其中D+、D-为差分输入线，使用3.3V电压。</span></span></li><li><span class="name"><span class="innerContentContainer">而电源线可向设备提供5V、最高500mA的电流。</span></span></li><li><span class="name"></span></li></ul></li><li><span class="name"><span class="innerContentContainer">生产流程</span></span><ul><li><span class="name"><span class="innerContentContainer">贴片</span></span><ul><li><span class="name"><span class="innerContentContainer">即把CPU等芯片贴到pcb板上，使用贴片机。然后有焊接工序。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">JDBC加载</span></span><ul><li><span class="name"><span class="innerContentContainer">jtag加载小boot包.</span></span></li><li><span class="name"><span class="innerContentContainer">内容包括qcsbl、oemsbl、partition、oeminfo的初始包（包括otp、logo等）等。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">DT</span></span><ul><li><span class="name"><span class="innerContentContainer">写单板条码到手机，检查烧片版本的版本信息。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">升级烧片</span></span><ul><li><span class="name"><span class="innerContentContainer">升级烧片版本。包括多个步骤，比如可能需要格式化U盘等。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">CT</span></span><ul><li><span class="name"><span class="innerContentContainer">校准射频参数；手机要进FTM模式。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">BT</span></span><ul><li><span class="name"><span class="innerContentContainer">综测。最耗时间的一个步骤。</span></span></li><li><span class="name"><span class="innerContentContainer">手机进FTM模式。</span></span></li><li><span class="name"><span class="innerContentContainer">无卡注册方案和快速注册方案也是用于这个阶段。</span></span><ul><li><span class="name"><span class="innerContentContainer">CDMA无卡注册方案方案</span></span><ul><li><span class="name"><span class="innerContentContainer">将频段、频点信息写入nv 60009，相关代码修改参见特性宏：DTS7X27_CDMA_LOCK_EREQ。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">WCDMA无卡注册方案</span></span><ul><li><span class="name"><span class="innerContentContainer">UMTS无卡注册方案是虚拟出一张sim卡，相关代码修改参见：HUAWEI_FEATHER_BT_NOSIM。</span></span></li></ul></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">MMI测试</span></span><ul><li><span class="name"><span class="innerContentContainer">MMI测试，确认各器件是否好用。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">MT</span></span><ul><li><span class="name"><span class="innerContentContainer">整机测试，测试天线，包括rf、gps、wifi。</span></span></li><li><span class="name"><span class="innerContentContainer">手机要进WT模式。</span></span></li><li><span class="name"><span class="innerContentContainer">PT</span></span></li><li><span class="name"><span class="innerContentContainer">整机电流测试，主要测试进待机、电池电压、温度和基底电流。</span></span></li><li><span class="name"><span class="innerContentContainer">相关方案是快速待机。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">正常升级</span></span><ul><li><span class="name"><span class="innerContentContainer">一般用SD卡升级方式（也有USB的），从工程菜单进入升级，以便升级前备份nv。</span></span></li><li><span class="name"><span class="innerContentContainer">现在升级大包中也放了cust包。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">MMI2</span></span><ul><li><span class="name"><span class="innerContentContainer">版本升级后进行mmi测试，再次确认各器件是否好用。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">CW(LT)</span></span><ul><li><span class="name"><span class="innerContentContainer">贴背贴，以前叫LT，现在叫CW。</span></span></li><li><span class="name"><span class="innerContentContainer">因为现在是离线打背贴，因为可以在生产前把背贴打印出来，加快生产效率。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">CW(LT)</span></span><ul><li><span class="name"><span class="innerContentContainer">关键的一步。</span></span></li><li><span class="name"><span class="innerContentContainer">写入sn、wifi/bt地址、IMEI(for gsm)/MEID/ESN(for cdma)、simlock数据等。</span></span></li><li><span class="name"><span class="innerContentContainer">做cust升级，即写入cust分区、写入vendor/country信息，然后重启。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">MC</span></span><ul><li><span class="name"><span class="innerContentContainer">功能是检查手机emei号和背贴上是否一致。</span></span></li><li><span class="name"><span class="innerContentContainer">要恢复出厂设置。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">彩包</span></span><ul><li><span class="name"><span class="innerContentContainer">彩包、装箱。</span></span></li><li><span class="name"><span class="innerContentContainer">产线流程结束。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">生产附属流程1：改制</span></span><ul><li><span class="name"><span class="innerContentContainer">即切换运营商。要修改IMEI，并进行cust升级。</span></span></li><li><span class="name"><span class="innerContentContainer">一般发生在产线和一线库房。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">生产附属流程2：开卡</span></span><ul><li><span class="name"><span class="innerContentContainer">仅针对机卡合一手机。</span></span></li><li><span class="name"><span class="innerContentContainer">在运营商营业点进行开卡操作，然后交付消费者使用。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">测试&amp;认证</span></span><ul><li><span class="name"><span class="innerContentContainer">GCF测试</span></span><ul><li><span class="name"><span class="innerContentContainer">GCF：全球认证论坛。</span></span></li><li><span class="name"><span class="innerContentContainer">高通可以帮助我们做；MTK也可以。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">FCC测试</span></span><ul><li><span class="name"><span class="innerContentContainer">主要用于测试射频。</span></span></li><li><span class="name"><span class="innerContentContainer">北美、南美需要这个测试。</span></span></li><li><span class="name"><span class="innerContentContainer">周期长，需要1.5到2个月才能拿到报告。</span></span></li><li><span class="name"><span class="innerContentContainer">关键点是改芯片或天线后，必须重新送测，即硬件不能改动过大。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">3C认证</span></span><ul><li><span class="name"><span class="innerContentContainer">即国家入网证，中国需要。</span></span></li><li><span class="name"><span class="innerContentContainer">拿报告比较简单。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">google TA认证</span></span><ul><li><span class="name"><span class="innerContentContainer">即CTS测试。</span></span></li><li><span class="name"><span class="innerContentContainer">广义的CTS 包括CTS/GTS/VTS 等6种测试套件.</span></span></li><li><span class="name"><span class="innerContentContainer">测试周期较长。CTS 现在有100多万条case (2019-12-15), 测试一次要3天.</span></span></li><li><span class="name"><span class="innerContentContainer">测试目的是保证android平台的兼容性。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">稳定性测试</span></span><ul><li><span class="name"><span class="innerContentContainer">统计指标是Monkey测试1000小时（或10部手机各100小时），死机、冻屏、重启多少次。</span></span></li><li><span class="name"><span class="innerContentContainer">指标:</span></span><ul><li><span class="name"><span class="innerContentContainer">tr4a：大T 2%，其它 4%。</span></span></li><li><span class="name"><span class="innerContentContainer">tr5：统一为1%。</span></span></li><li><span class="name"><span class="innerContentContainer">tr6：大T 0.2%，其它 0.4%。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">FFR的概念</span></span><ul><li><span class="name"><span class="innerContentContainer">现场失效率，指产品故障数占市场在保量的比例。</span></span></li><li><span class="name"><span class="innerContentContainer">故障率涵盖所有用户送来维修的问题手机，包括未复现。</span></span></li><li><span class="name"><span class="innerContentContainer">从诺基亚引入。</span></span></li><li><span class="name"><span class="innerContentContainer">FFR的公式: FFR=12 * 月度故障量 / 产品在保量。</span></span><ul><li><span class="name"><span class="innerContentContainer">这是个年化值;</span></span></li><li><span class="name"><span class="innerContentContainer">度故障率是采用三个月的平滑数据，所以上市头两个月没有数据。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">NFF</span></span><ul><li><span class="name"><span class="innerContentContainer">无故障返修率。即问题没有复现。</span></span></li><li><span class="name"><span class="innerContentContainer">在欧美甚多，因为欧美多采用直接换机策略，维修放在后台集中做，服务代表看不到客户，加大了复现问题的难度。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">EMC测试: 静电相关的测试</span></span></li><li><span class="name"><span class="innerContentContainer">常规测试</span></span><ul><li><span class="name"><span class="innerContentContainer">软件压力测试: 用自动测试软件连续给手机拨打1000个电话,检查手机是否会发生故障.</span></span></li><li><span class="name"><span class="innerContentContainer">抗摔性测试</span></span><ul><li><span class="name"><span class="innerContentContainer">抗摔性测试由专门的PRT可靠性实验来进行. </span></span></li><li><span class="name"><span class="innerContentContainer">半米的微跌落测试要做300/面(手机有6个面). </span></span></li><li><span class="name"><span class="innerContentContainer">2米的跌落测试每个面需各做一次.</span></span></li><li><span class="name"><span class="innerContentContainer">以及模拟人把手机扔到桌面的测试，要测试100次。</span></span></li><li><span class="name"><span class="innerContentContainer">电池要在4m高度，连续抛下100次后不能有断裂。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">高温低温测试</span></span><ul><li><span class="name"><span class="innerContentContainer">让手机处于高低不同的温度来检测手机的适应性。</span></span></li><li><span class="name"><span class="innerContentContainer">一般低温为-20度，高温80度。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">高湿度测试</span></span><ul><li><span class="name"><span class="innerContentContainer">用一个专门的箱子来操作滴水测试, 模拟人出汗的情况(水里面掺有一定比例的盐)。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">百格测试</span></span><ul><li><span class="name"><span class="innerContentContainer">用专用刀片在手机的外壳画100个格子10*10；</span></span></li><li><span class="name"><span class="innerContentContainer">用专用胶带粘其表面，以及用常见化妆品反复涂抹外壳，看会不会掉漆。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">翻盖测试</span></span><ul><li><span class="name"><span class="innerContentContainer">对翻盖手机进行翻盖10万次,检查壳体的损耗情况.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">扭矩测试</span></span><ul><li><span class="name"><span class="innerContentContainer">用夹具夹住两头,一头左拧,一头右拧.</span></span></li><li><span class="name"><span class="innerContentContainer">测试壳体和手机里面大型器件的强度.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">静电测试</span></span><ul><li><span class="name"><span class="innerContentContainer">冬季手摸金属的东西容易产生静电, 可能击穿手机电路.</span></span></li><li><span class="name"><span class="innerContentContainer">有专门的静电枪（10-15kV高压，低电流）和铜板来测试，持续时间之300ms到2s。</span></span></li><li><span class="name"><span class="innerContentContainer">充电器也要做。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">按键测试: 借助机器以给定的力量击打键盘10万次.</span></span></li><li><span class="name"><span class="innerContentContainer">沙尘测试</span></span><ul><li><span class="name"><span class="innerContentContainer">手机放入特定的箱子,细小的沙子被鼓吹起来.</span></span></li><li><span class="name"><span class="innerContentContainer">数小时后,察看手机里面是否有沙子进入.</span></span></li><li><span class="name"><span class="innerContentContainer">如果是,那么手机密闭性不好,结构设计有待重新调整.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">兼容性测试</span></span><ul><li><span class="name"><span class="innerContentContainer">sd卡兼容性</span></span></li><li><span class="name"><span class="innerContentContainer">usb兼容性</span></span></li><li><span class="name"><span class="innerContentContainer">蓝牙兼容性</span></span></li><li><span class="name"><span class="innerContentContainer">wifi兼容性</span></span></li><li><span class="name"><span class="innerContentContainer">sim卡兼容性</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">其它测试项</span></span><ul><li><span class="name"><span class="innerContentContainer">电池反接看是否有异常；</span></span></li><li><span class="name"><span class="innerContentContainer">靠近铁板、日光灯、心脏起搏器等打电话看是否有异常；</span></span></li><li><span class="name"><span class="innerContentContainer">长时间打电话，看发热情况。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">温升测试: 一次温升测试至少要4天，由硬测完成。</span></span></li><li><span class="name"><span class="innerContentContainer">射频测试: 一次简单射频指标的测试为1-2天；复杂指标要一周以上。</span></span></li><li><span class="name"><span class="innerContentContainer">dfx: 生产流程相关设计</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">IPD流程</span></span><ul><li><span class="name"><span class="innerContentContainer">tr1: 需求基线。tr1后需求就要处在变更控制下。</span></span></li><li><span class="name"><span class="innerContentContainer">charter: 任务书。</span></span></li><li><span class="name"><span class="innerContentContainer">CDCP: 概念决策评审点。概念阶段完成。</span></span></li><li><span class="name"><span class="innerContentContainer">tr2: 功能基线。确定产品规格需求。</span></span></li><li><span class="name"><span class="innerContentContainer">tr3</span></span><ul><li><span class="name"><span class="innerContentContainer">分配基线。</span></span></li><li><span class="name"><span class="innerContentContainer">入口条件完成SRS。</span></span></li><li><span class="name"><span class="innerContentContainer">此时软件开始投入，t0单板到位，底层开始调试点亮t0单板。</span></span></li><li><span class="name"><span class="innerContentContainer">第一阶段最大的风险点是T1烧片。T1（V3）大约tr3之后的一个月.</span></span></li><li><span class="name"><span class="innerContentContainer">t1烧片</span></span><ul><li><span class="name"><span class="innerContentContainer">等t0单板调通，最重要是装备和射频启动投入，开始为t1烧片和产线试制准备。</span></span></li><li><span class="name"><span class="innerContentContainer">t1烧片要求最主要的频段要可以CBT、升级、nv备份恢复等关键功能能通，经过裁剪的MMI、经过裁剪的产线流程要ok。</span></span></li><li><span class="name"><span class="innerContentContainer">t1烧片版本只转测试给硬测。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">PICP: 计划决策评审点，计划阶段完成。</span></span></li><li><span class="name"><span class="innerContentContainer">tr4</span></span><ul><li><span class="name"><span class="innerContentContainer">交付基线。软件模块工作完成，联调完成。</span></span></li><li><span class="name"><span class="innerContentContainer">注意: HLD/LLC/Coding/UT/ST/BBIT都发生在tr3到tr4之间。</span></span></li><li><span class="name"><span class="innerContentContainer">tr4前会出第一个正式转测试版本，软测团队开始介入；</span></span></li><li><span class="name"><span class="innerContentContainer">定价和配置器启动。</span></span></li><li><span class="name"><span class="innerContentContainer">软件经理要关注国家入网测试、认证测试、运营商准入测试送测时间点。</span></span></li><li><span class="name"><span class="innerContentContainer">试制 T2（V4）和tr4同时. </span></span></li><li><span class="name"><span class="innerContentContainer">tr4的出口条件</span></span><ul><li><span class="name"><span class="innerContentContainer">无致命问题。</span></span></li><li><span class="name"><span class="innerContentContainer">软件遗漏缺陷密度：目标是35，下限27，上限43；单位是“个/千行”。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">tr4a</span></span><ul><li><span class="name"><span class="innerContentContainer">系统设计验证/SDV。</span></span></li><li><span class="name"><span class="innerContentContainer">系统测试完成，性能测试ok。</span></span></li><li><span class="name"><span class="innerContentContainer">tr4a后，软件稳定度达到一定水平，开始检查软件APR。</span></span></li><li><span class="name"><span class="innerContentContainer">BOM发布，并开始首次爬坡（大致时间）；</span></span></li><li><span class="name"><span class="innerContentContainer">批量物料采购，部分达到；</span></span></li><li><span class="name"><span class="innerContentContainer">资料开发完成；</span></span></li><li><span class="name"><span class="innerContentContainer">销售模型完成。</span></span></li><li><span class="name"><span class="innerContentContainer">试制PP1（VN1, 小批量，硬件设计固化））在tr4a之后.</span></span></li><li><span class="name"><span class="innerContentContainer">tr4a的出口条件</span></span><ul><li><span class="name"><span class="innerContentContainer">内部问题单解决率85%;</span></span></li><li><span class="name"><span class="innerContentContainer">严重问题少于15个。</span></span></li><li><span class="name"><span class="innerContentContainer">底层软件的质量如果不能在tr4a之前稳定下来，产品的风险就比较大了。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">tr5</span></span><ul><li><span class="name"><span class="innerContentContainer">产品基线。</span></span></li><li><span class="name"><span class="innerContentContainer">此时有个活动，即beta test。</span></span></li><li><span class="name"><span class="innerContentContainer">内部测试完成；</span></span></li><li><span class="name"><span class="innerContentContainer">可少量早期发货。</span></span></li><li><span class="name"><span class="innerContentContainer">tr5的出口条件</span></span><ul><li><span class="name"><span class="innerContentContainer">软件DI&lt;40</span></span><ul><li><span class="name"><span class="innerContentContainer">DI值的计算方法:</span></span><ul><li><span class="name"><span class="innerContentContainer">致命问题10</span></span></li><li><span class="name"><span class="innerContentContainer">严重问题3</span></span></li><li><span class="name"><span class="innerContentContainer">一般问题1</span></span></li><li><span class="name"><span class="innerContentContainer">提示问题0.1</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">严重问题DI&lt;12。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">tr6</span></span><ul><li><span class="name"><span class="innerContentContainer">发布基线。</span></span></li><li><span class="name"><span class="innerContentContainer">过了tr6，产品就转维护。</span></span></li><li><span class="name"><span class="innerContentContainer">试制PP2（VN2, 第二次小批量）应在tr6之前完成。</span></span></li><li><span class="name"><span class="innerContentContainer">试制LV=Line Verification, EMS量产确认。和tr6同时进行. LV之后一般还有两次试制:</span></span><ul><li><span class="name"><span class="innerContentContainer">RU=Ramp UP，爬坡</span></span></li><li><span class="name"><span class="innerContentContainer"> MP=Mass Production, 量产</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">tr6的出口条件</span></span><ul><li><span class="name"><span class="innerContentContainer">总DI&lt;30;</span></span></li><li><span class="name"><span class="innerContentContainer">严重问题DI=0</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">各tr点间的周期</span></span><ul><li><span class="name"><span class="innerContentContainer">总时间:</span></span><ul><li><span class="name"><span class="innerContentContainer">A类项目charter后190天发货；</span></span></li><li><span class="name"><span class="innerContentContainer">B类项目时150天发货。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">tr3-tr4，一般2个月；</span></span></li><li><span class="name"><span class="innerContentContainer">tr4-tr4a，一般1.5-2个月；</span></span></li><li><span class="name"><span class="innerContentContainer">tr4a-tr5，两周；</span></span></li><li><span class="name"><span class="innerContentContainer">tr5-tr6，两-三周。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">试制的大致周期</span></span><ul><li><span class="name"><span class="innerContentContainer">每次试制间隔时间大约在1个月，不能少于20天，因为投板周期一般在两周左右。</span></span></li><li><span class="name"><span class="innerContentContainer">新产品投板次数不超过4次，非新产品一般2-3次。</span></span></li></ul></li></ul></li></ul>
  </body>
</html>