<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
      body {font-family:'Helvetica Neue', Arial, sans-serif; color:#333; font-size:13px; line-height:17px;}
      body .name,body .note {white-space:pre-wrap;}
      body ul {list-style:disc; margin:0; padding:0;}
      body li {margin:4px 0 4px 20px; padding:0;}
      body>.name {font-size:16px; line-height:21px;}
      body>.note {font-size:13px; line-height:17px;}
      body>ul {margin-top:15px;}
      body .name.done {text-decoration:line-through; color:#999;}
      body .note {font-size:12px; color:#666;}
    </style>
  </head>
  <body>
    <span class="name"><span class="innerContentContainer"><b>10-Activity</b></span></span><ul><li><span class="name"><span class="innerContentContainer"><b>Application类</b></span></span><ul><li><span class="name"><span class="innerContentContainer">一个虚拟机线程中只会有一个Application对象, 该对象的生命周期和线程相同.</span></span></li><li><span class="name"><span class="innerContentContainer">Application的实质是一个Context, 它继承ContextWrapper。</span></span></li><li><span class="name"><span class="innerContentContainer">由于在Context中可以通过 getApplicationContext()获取到 Application对象，或者是通过Activity.getApplication()、Service.getApplication()获取到Application(都是同一个对象)，所以可以在Application保存全局的数据，供所有的Activity或者是Service使用。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">Activity生命周期 <span class="contentTag" title="Filter #面试题">#<span class="contentTagText">面试题</span><span class="contentTagNub"></span></span> </span></span><ul><li><span class="name"><span class="innerContentContainer">Activity生命周期图, 要看图.  <span class="contentTag" title="Filter @iChart">@<span class="contentTagText">iChart</span><span class="contentTagNub"></span></span> </span></span></li><li><span class="name"><span class="innerContentContainer"><b>onCreate&nbsp;</b>: Activity被创建时被回调，是生命周期第一个调用的方法，我们在创建Activity时一般会重写该方法做一些初始化的操作，如通过 setContentView 设置界面布局的资源，初始化所需要的组件信息等。</span></span></li><li><span class="name"><span class="innerContentContainer"><b>onStart&nbsp;</b>: Activity正在启动时回调，此时Activity已处于可见状态，但是还没有在前台显示，因此无法与用户进行交互。</span></span></li><li><span class="name"><span class="innerContentContainer"><b>onResume </b>: 当此方法回调时，则说明Activity已在前台可见，可与用户交互了, 即activity处于 Active/Running形态.</span></span><ul><li><span class="name"><span class="innerContentContainer">onResume与onStart的相同点是两者都表示Activity可见；</span></span></li><li><span class="name"><span class="innerContentContainer">不同点是onStart时Activity还在后台无法与用户交互，而onResume则表示已显示在前台，可与用户交互。</span></span></li><li><span class="name"><span class="innerContentContainer">当Activity停止后（ onPause 方法和 onStop方法被调用），重新回到前台时也会调用onResume方法.</span></span></li><li><span class="name"><span class="innerContentContainer">可以在onResume方法中初始化一些资源，比如重新初始化在 onPause 或者 onStop 方法中释放的资源。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer"><b>onPause </b>: Activity被切换到后台或停止的时候回调, 此时activity进入 Paused形态. 一般情况下 onStop方法接下来会马上被回调。</span></span><ul><li><span class="name"><span class="innerContentContainer">在onPause中我们可以做一些数据存储或者动画停止或者资源回收的操作，但是不能太耗时，因为这可能会影响到新的Activity的显示. <b>因为旧activity的 onPause方法执行完成后，新Activity的onResume方法才会被执行。</b></span></span></li><li><span class="name"><span class="innerContentContainer">onPause()和onStop()的区别是：前者是旧Activity还可见的状态；后者是旧Activity已经不可见。</span></span></li><li><span class="name"><span class="innerContentContainer">AlertDialog 和 PopWindow 不会触发onPause()和onStop().</span></span></li><li><span class="name"><span class="innerContentContainer">有一种极端情况是onPause方法执行后马上执行了onResume方法，一般是用户操作使当前Activity退居后台后又迅速切回来，此时onResume方法就会被回调。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer"><b>onStop </b>: 一般在onPause执行完成时回调，表示Activity即将停止进入Stopped形态，此时Activity不可见，仅在后台运行。在onStop方法可以做一些资源释放的操作（不能太耗时）。</span></span></li><li><span class="name"><span class="innerContentContainer"><b>onRestart </b>: 表示Activity正在重新启动，当Activity由<b>onStop</b>() 状态切换回前台时，该方法被回调。这种情况一般是用户打开了一个新的Activity时，当前的Activity就会被暂停（onPause和onStop被执行了），接着又回到当前Activity页面时，onRestart方法就会被回调。</span></span></li><li><span class="name"><span class="innerContentContainer"><b>onDestroy </b>: 此时Activity正在被销毁，也是生命周期最后一个执行的方法，一般我们可以在此方法中做最终的资源释放。</span></span></li><li><span class="name"><span class="innerContentContainer">总结下: </span></span><ul><li><span class="name"><span class="innerContentContainer">Activity第一启动的时候执行: onCreate() -&gt; onStart() -&gt; onResume(). </span></span></li><li><span class="name"><span class="innerContentContainer">如果再有启动同一Activity的时候, 执行: onNewIntent() -&gt; onResart() -&gt; onStart() -&gt; onResume().</span></span></li><li><span class="name"><span class="innerContentContainer">如果android系统由于内存不足把已存在Activity释放掉了，那么再次调用的时候会重新启动Activity, 即执行: onCreate() -&gt; onStart() -&gt; onResume()。</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">横竖屏切换 <span class="contentTag" title="Filter #面试题">#<span class="contentTagText">面试题</span><span class="contentTagNub"></span></span></span></span><ul><li><span class="name"><span class="innerContentContainer">横竖屏切换的时候会销毁当前的Activity然后重新创建一个. </span></span></li><li><span class="name"><span class="innerContentContainer">横竖屏切换时会走这个生命周期：onPause -&gt; onStop -&gt; onDestory -&gt; onCreate -&gt; onStart -&gt; onResume</span></span></li><li><span class="name"><span class="innerContentContainer">准备两套不同的布局，Android会自己根据横竖屏加载不同布局. 创建两个布局文件夹：</span></span><ul><li><span class="name"><span class="innerContentContainer">layout-land: 横屏</span></span></li><li><span class="name"><span class="innerContentContainer">layout-port: 竖屏</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">在onCreate()方法中判断横竖屏</span></span><ul><li><span class="name"><span class="innerContentContainer">if (this.getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE){</span></span><ul><li><span class="name"><span class="innerContentContainer">setContentView(R.layout.横屏);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">} else if (this.getResources().getConfiguration().orientation ==Configuration.ORIENTATION_PORTRAIT) {</span></span><ul><li><span class="name"><span class="innerContentContainer">setContentView(R.layout.竖屏);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"></span></li></ul></li><li><span class="name"><span class="innerContentContainer">禁止屏幕横竖屏自动切换</span></span><ul><li><span class="name"><span class="innerContentContainer">在AndroidManifest.xml中为Act添加一个属性：&nbsp;android:screenOrientation, 值域是:</span></span></li><li><span class="name"><span class="innerContentContainer">unspecified: 默认值.由系统来判断显示方向.判定的策略是和设备相关的，所以不同的设备会有不同的显示方向。</span></span></li><li><span class="name"><span class="innerContentContainer">landscape: 横屏显示（宽比高要长）</span></span></li><li><span class="name"><span class="innerContentContainer">portrait: 竖屏显示(高比宽要长)</span></span></li><li><span class="name"><span class="innerContentContainer">user: 用户当前首选的方向</span></span></li><li><span class="name"><span class="innerContentContainer">behind: 和Activity堆栈中前面那个Activity的方向一致.</span></span></li><li><span class="name"><span class="innerContentContainer">sensor: 有物理的感应器来决定。如果用户旋转设备这屏幕会横竖屏切换。</span></span></li><li><span class="name"><span class="innerContentContainer">nosensor: 忽略物理感应器，这样就不会随着用户旋转设备而更改了（"unspecified"设置除外）。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">系统给我们提供的常见的Activity</span></span><ul><li><span class="name"><span class="innerContentContainer">拨打电话</span></span><ul><li><span class="name"><span class="innerContentContainer">// 给移动客服10086拨打电话</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("tel:10086");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_DIAL, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">发送短信</span></span><ul><li><span class="name"><span class="innerContentContainer">// 给10086发送内容为“Hello”的短信</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("smsto:10086");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_SENDTO, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("sms_body", "Hello");</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">发送彩信（相当于发送带附件的短信）</span></span><ul><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_SEND);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("sms_body", "Hello");</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("content://media/external/images/media/23");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_STREAM, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setType("image/png");</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">打开浏览器</span></span><ul><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("http://www.baidu.com");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent&nbsp; = new Intent(Intent.ACTION_VIEW, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">发送电子邮件(阉割了Google服务的没戏)</span></span><ul><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("mailto:<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:someone@domain.com">someone@domain.com</a>");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_SENDTO, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li><li><span class="name"><span class="innerContentContainer">// 给<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:someone@domain.com">someone@domain.com</a>发邮件发送内容为“Hello”的邮件</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_SEND);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_EMAIL, "<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:someone@domain.com">someone@domain.com</a>");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_SUBJECT, "Subject");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_TEXT, "Hello");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setType("text/plain");</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li><li><span class="name"><span class="innerContentContainer">// 给多人发邮件</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent=new Intent(Intent.ACTION_SEND);</span></span></li><li><span class="name"><span class="innerContentContainer">String[] tos = {"<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:1@abc.com">1@abc.com</a>", "<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:2@abc.com">2@abc.com</a>"}; // 收件人</span></span></li><li><span class="name"><span class="innerContentContainer">String[] ccs = {"<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:3@abc.com">3@abc.com</a>", "<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:4@abc.com">4@abc.com</a>"}; // 抄送</span></span></li><li><span class="name"><span class="innerContentContainer">String[] bccs = {"<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:5@abc.com">5@abc.com</a>", "<a class="contentLink" target="_blank" rel="noreferrer" href="mailto:6@abc.com">6@abc.com</a>"}; // 密送</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_EMAIL, tos);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_CC, ccs);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_BCC, bccs);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_SUBJECT, "Subject");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(Intent.EXTRA_TEXT, "Hello");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setType("message/rfc822");</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">显示地图</span></span><ul><li><span class="name"><span class="innerContentContainer">// 打开Google地图中国北京位置（北纬39.9，东经116.3）</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("geo:39.9,116.3");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_VIEW, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">路径规划</span></span><ul><li><span class="name"><span class="innerContentContainer">// 路径规划：从北京某地（北纬39.9，东经116.3）到上海某地（北纬31.2，东经121.4）</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("http://maps.google.com/maps?f=d&amp;saddr=39.9 116.3&amp;daddr=31.2 121.4");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_VIEW, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">多媒体播放</span></span><ul><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_VIEW);</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("file:///sdcard/foo.mp3");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setDataAndType(uri, "audio/mp3");</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li><li><span class="name"><span class="innerContentContainer">// 获取SD卡下所有音频文件,然后播放第一首=-=</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.withAppendedPath(MediaStore.Audio.Media.INTERNAL_CONTENT_URI, "1");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_VIEW, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">打开摄像头拍照</span></span><ul><li><span class="name"><span class="innerContentContainer">// 打开拍照程序</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivityForResult(intent, 0);</span></span></li><li><span class="name"><span class="innerContentContainer">// 取出照片数据</span></span></li><li><span class="name"><span class="innerContentContainer">Bundle extras = intent.getExtras();</span></span></li><li><span class="name"><span class="innerContentContainer">Bitmap bitmap = (Bitmap) extras.get("data");</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">调用系统相机应用程序，并存储拍下来的照片</span></span><ul><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);</span></span></li><li><span class="name"><span class="innerContentContainer">time = Calendar.getInstance().getTimeInMillis();</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(new File(Environment</span></span></li><li><span class="name"><span class="innerContentContainer">.getExternalStorageDirectory().getAbsolutePath()+"/tucue", time + ".jpg")));</span></span></li><li><span class="name"><span class="innerContentContainer">startActivityForResult(intent, ACTIVITY_GET_CAMERA_IMAGE);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">获取并剪切图片</span></span><ul><li><span class="name"><span class="innerContentContainer">// 获取并剪切图片</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_GET_CONTENT);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setType("image/*");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("crop", "true"); // 开启剪切</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("aspectX", 1); // 剪切的宽高比为1：2</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("aspectY", 2);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("outputX", 20); // 保存图片的宽和高</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("outputY", 40);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("output", Uri.fromFile(new File("/mnt/sdcard/temp"))); // 保存路径</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("outputFormat", "JPEG");// 返回格式</span></span></li><li><span class="name"><span class="innerContentContainer">startActivityForResult(intent, 0);</span></span></li><li><span class="name"><span class="innerContentContainer">// 剪切特定图片</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent("com.android.camera.action.CROP");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setClassName("com.android.camera", "com.android.camera.CropImage");</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setData(Uri.fromFile(new File("/mnt/sdcard/temp")));</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("outputX", 1); // 剪切的宽高比为1：2</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("outputY", 2);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("aspectX", 20); // 保存图片的宽和高</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("aspectY", 40);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("scale", true);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("noFaceDetection", true);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.putExtra("output", Uri.parse("file:///mnt/sdcard/temp"));</span></span></li><li><span class="name"><span class="innerContentContainer">startActivityForResult(intent, 0);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">打开Google Market</span></span><ul><li><span class="name"><span class="innerContentContainer">// 打开Google Market直接进入该程序的详细页面</span></span></li><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.parse("market://details?id=" + "com.demo.app");</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(Intent.ACTION_VIEW, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">进入手机设置界面</span></span><ul><li><span class="name"><span class="innerContentContainer">// 进入无线网络设置界面（其它可以举一反三）</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent(android.provider.Settings.ACTION_WIRELESS_SETTINGS);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivityForResult(intent, 0);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">安装apk</span></span><ul><li><span class="name"><span class="innerContentContainer">Uri installUri = Uri.fromParts("package", "xxx", null);</span></span></li><li><span class="name"><span class="innerContentContainer">returnIt = new Intent(Intent.ACTION_PACKAGE_ADDED, installUri);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">卸载apk</span></span><ul><li><span class="name"><span class="innerContentContainer">Uri uri = Uri.fromParts("package", strPackageName, null);</span></span></li><li><span class="name"><span class="innerContentContainer">Intent it = new Intent(Intent.ACTION_DELETE, uri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(it);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">发送附件</span></span><ul><li><span class="name"><span class="innerContentContainer">Intent it = new Intent(Intent.ACTION_SEND);</span></span></li><li><span class="name"><span class="innerContentContainer">it.putExtra(Intent.EXTRA_SUBJECT, "The email subject text");</span></span></li><li><span class="name"><span class="innerContentContainer">it.putExtra(Intent.EXTRA_STREAM, "file:///sdcard/eoe.mp3");</span></span></li><li><span class="name"><span class="innerContentContainer">sendIntent.setType("audio/mp3");</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(Intent.createChooser(it, "Choose Email Client"));</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">进入联系人页面</span></span><ul><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent();</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setAction(Intent.ACTION_VIEW);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setData(People.CONTENT_URI);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">查看指定联系人</span></span><ul><li><span class="name"><span class="innerContentContainer">Uri personUri = ContentUris.withAppendedId(People.CONTENT_URI, info.id);  //info.id联系人ID</span></span></li><li><span class="name"><span class="innerContentContainer">Intent intent = new Intent();</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setAction(Intent.ACTION_VIEW);</span></span></li><li><span class="name"><span class="innerContentContainer">intent.setData(personUri);</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(intent);</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">Activity间的数据传递 <span class="contentTag" title="Filter #面试题">#<span class="contentTagText">面试题</span><span class="contentTagNub"></span></span> </span></span><ul><li><span class="name"><span class="innerContentContainer"><b>Intent </b>it = new Intent(MyActivity.this, MyActivity2.class);</span></span></li><li><span class="name"><span class="innerContentContainer"><b>Bundle </b>bd = new Bundle();   // // 新建Bundle对象,并把数据写入</span></span></li><li><span class="name"><span class="innerContentContainer">bd.putCharSequence("user",name);</span></span></li><li><span class="name"><span class="innerContentContainer">bd.putCharSequence("sex",sex);</span></span></li><li><span class="name"><span class="innerContentContainer">it.<b>putExtras</b>(bd);  // 将数据包Bundle绑定到Intent上</span></span></li><li><span class="name"><span class="innerContentContainer">startActivity(it);   // 启动第二个activity</span></span></li><li><span class="name"><span class="innerContentContainer">finish();   // 关闭第一个Activity</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">一次性关闭所有Activity</span></span><ul><li><span class="name"><span class="innerContentContainer">public class ActivityCollector {</span></span><ul><li><span class="name"><span class="innerContentContainer">// 用一个list集合来存储所有Activity</span></span></li><li><span class="name"><span class="innerContentContainer">public static LinkedList&lt;Activity&gt; activities = new LinkedList&lt;Activity&gt;();</span></span></li><li><span class="name"><span class="innerContentContainer">public static void addActivity(Activity activity) {</span></span><ul><li><span class="name"><span class="innerContentContainer">activities.add(activity);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">public static void removeActivity(Activity activity) {</span></span><ul><li><span class="name"><span class="innerContentContainer">activities.remove(activity);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">public static void finishAll() {</span></span><ul><li><span class="name"><span class="innerContentContainer">for(Activity activity:activities) {</span></span><ul><li><span class="name"><span class="innerContentContainer">if(!activity.isFinishing()) {</span></span><ul><li><span class="name"><span class="innerContentContainer">activity.finish();</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">假如app中所有的activity 都继承自 BaseActivity.  在它的 onCreate() 中调用 ActivityCollector.addActivity(this);  在 onDestory() 中调用 ActivityCollector.removeActivity().</span></span></li><li><span class="name"><span class="innerContentContainer">然后在任何地方调用 ActivityCollector.finishAll() 即可关闭所有的activity.</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">完全退出App</span></span><ul><li><span class="name"><span class="innerContentContainer">上面是关闭所有的activity, 但是app并没有退出, 因为还有service. </span></span></li><li><span class="name"><span class="innerContentContainer">下面是完全退出app的代码:</span></span></li><li><span class="name"><span class="innerContentContainer">public void AppExit(Context context) {</span></span><ul><li><span class="name"><span class="innerContentContainer">try {</span></span><ul><li><span class="name"><span class="innerContentContainer">ActivityCollector.finishAll();</span></span></li><li><span class="name"><span class="innerContentContainer">ActivityManager activityMgr = (ActivityManager) context</span></span><ul><li><span class="name"><span class="innerContentContainer">.getSystemService(Context.ACTIVITY_SERVICE);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">activityMgr.killBackgroundProcesses(context.getPackageName());</span></span></li><li><span class="name"><span class="innerContentContainer">System.exit(0);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">} catch (Exception ignored) {}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">为Activity设置过场动画</span></span><ul><li><span class="name"><span class="innerContentContainer">过场动画就是切换到另外的Activity时加上一些切换动画，比如淡入淡出，放大缩小，左右互推等.</span></span></li><li><span class="name"></span></li><li><span class="name"><span class="innerContentContainer">通过style进行配置，这个是全局的哦，就是所有的Activity都会加载这个动画.</span></span></li><li><span class="name"><span class="innerContentContainer">(1) 在style.xml中自定义style：</span></span></li><li><span class="name"><span class="innerContentContainer">&lt;!-- 默认Activity跳转动画 --&gt;</span></span></li><li><span class="name"><span class="innerContentContainer">&lt;style name="default_animation" mce_bogus="1" parent="@android:style/Animation.Activity"&gt;</span></span><ul><li><span class="name"><span class="innerContentContainer">&lt;item name="android:activityOpenEnterAnimation"&gt;@anim/default_anim_in&lt;/item&gt;</span></span></li><li><span class="name"><span class="innerContentContainer">&lt;item name="android:activityOpenExitAnimation"&gt;@anim/anim_stay&lt;/item&gt;</span></span></li><li><span class="name"><span class="innerContentContainer">&lt;item name="android:activityCloseEnterAnimation"&gt;@anim/anim_stay&lt;/item&gt;</span></span></li><li><span class="name"><span class="innerContentContainer">&lt;item name="android:activityCloseExitAnimation"&gt;@anim/default_anim_out&lt;/item&gt;</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">&lt;/style&gt;</span></span></li><li><span class="name"><span class="innerContentContainer">4个item分别代表:</span></span></li><li><span class="name"><span class="innerContentContainer">Activity A跳转到Activity B时Activity B进入动画;</span></span></li><li><span class="name"><span class="innerContentContainer">Activity A跳转到Activity B时Activity A退出动画;</span></span></li><li><span class="name"><span class="innerContentContainer">Activity B返回Activity A时Activity A的进入动画</span></span></li><li><span class="name"><span class="innerContentContainer">Activity B返回Activity A时ActivityB的退出动画</span></span></li><li><span class="name"><span class="innerContentContainer"><b>(2) 然后修改下AppTheme:</b>&lt;style name="AppTheme" mce_bogus="1" parent="@android:style/Theme.Light"&gt;</span></span><ul><li><span class="name"><span class="innerContentContainer">&lt;item name="android:windowAnimationStyle"&gt;@style/default_animation&lt;/item&gt;</span></span></li><li><span class="name"><span class="innerContentContainer">&lt;item name="android:windowNoTitle"&gt;true&lt;/item&gt;</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">&lt;/style&gt;</span></span></li><li><span class="name"><span class="innerContentContainer"><b>(3) 最后在appliction设置下：</b></span></span></li><li><span class="name"><span class="innerContentContainer">&lt;application</span></span><ul><li><span class="name"><span class="innerContentContainer">android:icon="@drawable/logo"</span></span></li><li><span class="name"><span class="innerContentContainer">android:label="@string/app_name"</span></span></li><li><span class="name"><span class="innerContentContainer">android:theme="@style/AppTheme" &gt;</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">设置Activity全屏</span></span><ul><li><span class="name"><span class="innerContentContainer">1. 代码隐藏ActionBar</span></span><ul><li><span class="name"><span class="innerContentContainer">在Activity的onCreate方法中调用getActionBar.hide();即可</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">2. 通过requestWindowFeature设置</span></span><ul><li><span class="name"><span class="innerContentContainer">requestWindowFeature(Window.FEATURE_NO_TITLE);  // 需要在setContentView ()之前调用. </span></span></li><li><span class="name"><span class="innerContentContainer">把 requestWindowFeature(Window.FEATURE_NO_TITLE); 放在super.onCreate(savedInstanceState);前面就可以隐藏ActionBar而不报错。</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">3. 通过AndroidManifest.xml的theme</span></span><ul><li><span class="name"><span class="innerContentContainer">在需要全屏的Activity的标签内设置 theme = <span class="contentTag" title="Filter @android:style">@<span class="contentTagText">android:style</span><span class="contentTagNub"></span></span>/Theme.NoTitleBar.FullScreen</span></span></li></ul></li></ul></li><li><span class="name"><span class="innerContentContainer">定义对话框风格的Activity</span></span><ul><li><span class="name"><span class="innerContentContainer">Activity一般是占满全屏的， 而Dialog则是占据部分屏幕的.</span></span></li><li><span class="name"><span class="innerContentContainer">直接设置下Activity的theme: android:theme="@android:style/Theme.Dialog" 即可.</span></span></li><li><span class="name"><span class="innerContentContainer">// 然后再设置左上角小图标</span></span></li><li><span class="name"><span class="innerContentContainer">requestWindowFeature(Window.FEATURE_LEFT_ICON);</span></span></li><li><span class="name"><span class="innerContentContainer">setContentView(R.layout.main);</span></span></li><li><span class="name"><span class="innerContentContainer">getWindow().setFeatureDrawableResource(Window.FEATURE_LEFT_ICON, android.R.drawable.ic_lion_icon);</span></span></li><li><span class="name"><span class="innerContentContainer">// 设置文字:</span></span></li><li><span class="name"><span class="innerContentContainer">setTitle(R.string.actdialog_title);  //XML代码中设置:android:label="@string/activity_dialog"</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">开源中国客户端Activity管理类 --还在哪里?</span></span><ul><li><span class="name"><span class="innerContentContainer">package net.oschina.app;</span></span></li><li><span class="name"><span class="innerContentContainer">import java.util.Stack;</span></span></li><li><span class="name"><span class="innerContentContainer">import android.app.Activity;</span></span></li><li><span class="name"><span class="innerContentContainer">import android.app.ActivityManager;</span></span></li><li><span class="name"><span class="innerContentContainer">import android.content.Context;</span></span></li><li><span class="name"><span class="innerContentContainer">public class AppManager {</span></span><ul><li><span class="name"><span class="innerContentContainer">private static Stack&lt;Activity&gt; activityStack;</span></span></li><li><span class="name"><span class="innerContentContainer">private static AppManager instance;</span></span></li><li><span class="name"><span class="innerContentContainer">private AppManager(){}</span></span></li><li><span class="name"><span class="innerContentContainer">/* 单一实例 */</span></span></li><li><span class="name"><span class="innerContentContainer">public static AppManager getAppManager(){</span></span><ul><li><span class="name"><span class="innerContentContainer">if(instance==null){</span></span><ul><li><span class="name"><span class="innerContentContainer">instance=new AppManager();</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">return instance;</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">/**</span></span><ul><li><span class="name"><span class="innerContentContainer">添加Activity到堆栈</span></span></li><li><span class="name"><span class="innerContentContainer">*/</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">public void addActivity(Activity activity){</span></span><ul><li><span class="name"><span class="innerContentContainer">if(activityStack==null){</span></span><ul><li><span class="name"><span class="innerContentContainer">activityStack=new Stack&lt;Activity&gt;();</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">activityStack.add(activity);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">/* 获取当前Activity（堆栈中最后一个压入的） */</span></span></li><li><span class="name"><span class="innerContentContainer">public Activity currentActivity(){</span></span><ul><li><span class="name"><span class="innerContentContainer">Activity activity=activityStack.lastElement();</span></span></li><li><span class="name"><span class="innerContentContainer">return activity;</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">/* 结束当前Activity（堆栈中最后一个压入的） */</span></span></li><li><span class="name"><span class="innerContentContainer">public void finishActivity(){</span></span><ul><li><span class="name"><span class="innerContentContainer">Activity activity=activityStack.lastElement();</span></span></li><li><span class="name"><span class="innerContentContainer">finishActivity(activity);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">/**</span></span><ul><li><span class="name"><span class="innerContentContainer">结束指定的Activity</span></span></li><li><span class="name"><span class="innerContentContainer">*/</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">public void finishActivity(Activity activity){</span></span><ul><li><span class="name"><span class="innerContentContainer">if(activity!=null){</span></span><ul><li><span class="name"><span class="innerContentContainer">activityStack.remove(activity);</span></span></li><li><span class="name"><span class="innerContentContainer">activity.finish();</span></span></li><li><span class="name"><span class="innerContentContainer">activity=null;</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">/* 结束指定类名的Activity */</span></span></li><li><span class="name"><span class="innerContentContainer">public void finishActivity(Class&lt;?&gt; cls){</span></span><ul><li><span class="name"><span class="innerContentContainer">for (Activity activity : activityStack) {</span></span><ul><li><span class="name"><span class="innerContentContainer">if(activity.getClass().equals(cls) ){</span></span><ul><li><span class="name"><span class="innerContentContainer">finishActivity(activity);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">/* 结束所有Activity */</span></span></li><li><span class="name"><span class="innerContentContainer">public void finishAllActivity(){</span></span><ul><li><span class="name"><span class="innerContentContainer">for (int i = 0, size = activityStack.size(); i &lt; size; i++){</span></span><ul><li><span class="name"><span class="innerContentContainer">if (null != activityStack.get(i)){</span></span><ul><li><span class="name"><span class="innerContentContainer">activityStack.get(i).finish();</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">activityStack.clear();</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li><li><span class="name"><span class="innerContentContainer">/* 退出应用程序 */</span></span></li><li><span class="name"><span class="innerContentContainer">public void AppExit(Context context) {</span></span><ul><li><span class="name"><span class="innerContentContainer">try {</span></span><ul><li><span class="name"><span class="innerContentContainer">finishAllActivity();</span></span></li><li><span class="name"><span class="innerContentContainer">ActivityManager activityMgr= (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);</span></span></li><li><span class="name"><span class="innerContentContainer">activityMgr.restartPackage(context.getPackageName());</span></span></li><li><span class="name"><span class="innerContentContainer">System.exit(0);</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">} catch (Exception e) {&nbsp; &nbsp; }</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li><li><span class="name"><span class="innerContentContainer">}</span></span></li></ul></li></ul>
  </body>
</html>